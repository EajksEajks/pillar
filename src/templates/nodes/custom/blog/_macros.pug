//- ******************************************************* -//
| {% macro render_blog_post(node) %}
| {% if node.picture %}
.blog_index-header
	img(src="{{ node.picture.thumbnail('l', api=api) }}")
| {% endif %}
.blog_index-item
	a.item-title(
		href="{{ url_for_node(node=node) }}")
		| {{node.name}}

	.item-info.
		<span title="{{node._created}}">{{node._created | pretty_date }}</span>
		{% if node._created != node._updated %}
		<span title="{{node._updated}}">(updated {{node._updated | pretty_date }})</span>
		{% endif %}
		{% if node.properties.category %}| {{node.properties.category}}{% endif %}
		| by {{node.user.full_name}}
		| <a href="{{ url_for_node(node=node) }}#comments">Leave a comment</a>
		{% if node.properties.status != 'published' %} | {{ node.properties.status}} {% endif %}

	.item-content
		| {{node.properties.content}}

	.item-meta
		a(href="{{ url_for_node(node=node) }}#comments") Leave a comment
| {% endmacro %}

//- ******************************************************* -//
| {% macro render_blog_list_item(node) %}
.blog_index-item.list
	| {% if node.picture %}
	.item-header
		img.image(src="{{ node.picture.thumbnail('s', api=api) }}")
	| {% else %}
	.item-header.nothumb
		i.pi-document-text
	| {% endif %}
	a.item-title(
		href="{{ url_for_node(node=node) }}")
		| {{node.name}}

	.item-info.
		<span title="{{node._created}}">{{node._created | pretty_date }}</span>
		{% if node._created != node._updated %}
		<span title="{{node._updated}}">(updated {{node._updated | pretty_date }})</span>
		{% endif %}
		{% if node.properties.category %}| {{node.properties.category}}{% endif %}
		| by {{node.user.full_name}}
		{% if node.properties.status != 'published' %} | {{ node.properties.status}} {% endif %}
| {% endmacro %}


//- ******************************************************* -//
| {% macro render_blog_index(project, posts, can_create_blog_posts, api, more_posts_available, posts_meta) %}
| {% if can_create_blog_posts %}
a.btn.btn-default.button-create(href="{{url_for('nodes.posts_create', project_id=project._id)}}")
	i.pi-plus
	| Create New Post
| {% endif %}

| {% if posts %}
| {{ render_blog_post(posts[0]) }}

| {% for node in posts[1:] %}
| {% if loop.first %}
h4.blog_index-title Blasts from the past
| {% endif %}
| {{ render_blog_list_item(node) }}
| {% endfor %}

| {% if more_posts_available %}
h4.blog_index-title.blog-archive
	a(href="{{ project.blog_archive_url }}")
		| {{posts_meta.total - posts|length}} more blog posts over here
		i.pi-angle-right
| {% endif %}

| {% else %}

.blog_index-item
	.item-content No posts yet.

| {% endif %} {# posts #}
| {% endmacro %}

//- ******************************************************* -//

| {% macro render_archive_pagination(project) %}
h4.blog_index-title.blog-archive
	a(class="{% if not project.blog_archive_prev %}disabled{% endif %}",
		href="{{ project.blog_archive_prev }}", rel="prev")
		i.pi-angle-left
		| Previous page

	a(href="{{ url_for('main.project_blog', project_url=project.url) }}", rel="prev")
		| Blog Index

	a(class="{% if not project.blog_archive_next %}disabled{% endif %}",
		href="{{ project.blog_archive_next }}", rel="next")
		| Next page
		i.pi-angle-right
| {% endmacro %}

| {% macro render_archive(project, posts, posts_meta) %}

| {{ render_archive_pagination(project) }}

| {% for node in posts %}
| {{ render_blog_list_item(node) }}
| {% endfor %}

| {{ render_archive_pagination(project) }}

| {% endmacro %}
